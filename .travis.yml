sudo: required
dist: trusty

language: java
python:
        - "2.7"
go:
        - 1.x
jdk:
  - oraclejdk8

before_install:
        - pip install --user --upgrade -r requirements.txt

addons:
  apt:
    sources:
    - sourceline: 'deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8'
      key_url: 'https://storage.googleapis.com/bazel-apt/doc/apt-key.pub.gpg'
    - debian-sid

    packages:
    - shellcheck
    - bazel

install:
  - go get -u github.com/bazelbuild/buildifier/buildifier
  - export GOPATH="/home/travis/gopath/src/"

script:
 - find . -name "*.sh" | grep -v iDiff | xargs shellcheck
 - flake8 .
 - ./.gofmt.sh
 - ./.buildifier.sh
 - python -m unittest discover -s reconciletags -p 'reconciletags_test.py'
 - bazel clean && bazel build //...
 - go test `go list ./... | grep iDiff | grep -v iDiff/vendor` 
